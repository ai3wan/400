<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–í–°–ú400 ‚Äî –¶–µ–Ω—Ç—Ä –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Manrope', 'Inter', system-ui, -apple-system, sans-serif;
      background: #f8fafc;
      color: #0f172a;
      font-size: 16px;
      line-height: 1.6;
    }
    .header {
      background: linear-gradient(135deg, #0099CC 0%, #3B82F6 100%);
      color: white;
      padding: 24px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .header h1 { font-size: 28px; font-weight: 700; }
    .header-controls {
      display: flex;
      gap: 16px;
      align-items: center;
      font-size: 14px;
    }
    .header-controls button {
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    .header-controls button:hover { background: rgba(255,255,255,0.3); }
    
    /* Fixed navigation sidebar */
    .nav-sidebar {
      position: fixed;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.15);
      padding: 12px 8px;
      z-index: 99;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .nav-sidebar a {
      display: block;
      padding: 10px 14px;
      text-decoration: none;
      color: #475569;
      font-size: 13px;
      border-radius: 8px;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .nav-sidebar a:hover,
    .nav-sidebar a.active {
      background: #0099CC;
      color: white;
    }

    .container { max-width: 1600px; margin: 0 auto; padding: 32px 40px; }
    
    /* Section styling */
    .section {
      background: white;
      border-radius: 20px;
      padding: 40px;
      margin-bottom: 32px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      scroll-margin-top: 100px;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s ease-out;
    }
    .section.visible { opacity: 1; transform: translateY(0); }
    .section-title {
      font-size: 32px;
      font-weight: 700;
      color: #0f172a;
      margin-bottom: 8px;
      border-left: 4px solid #0099CC;
      padding-left: 16px;
    }
    .section-subtitle {
      font-size: 16px;
      color: #64748b;
      margin-bottom: 32px;
      padding-left: 20px;
    }

    /* Master KPI Panel */
    .kpi-panel {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 20px;
      margin-bottom: 24px;
    }
    .kpi-card {
      background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
      border-radius: 16px;
      padding: 24px;
      border-left: 5px solid;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      transition: all 0.3s;
    }
    .kpi-card:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.12); }
    .kpi-card.status-ok { border-left-color: #10b981; }
    .kpi-card.status-warn { border-left-color: #f59e0b; }
    .kpi-card.status-crit { border-left-color: #ef4444; }
    .kpi-card.status-info { border-left-color: #0099CC; }
    .kpi-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 16px;
    }
    .kpi-icon { font-size: 32px; }
    .kpi-label {
      font-size: 14px;
      color: #64748b;
      font-weight: 500;
      margin-bottom: 8px;
    }
    .kpi-value {
      font-size: 42px;
      font-weight: 700;
      color: #0f172a;
      margin: 8px 0;
    }
    .kpi-trend {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      color: #64748b;
      margin-top: 8px;
    }
    .kpi-sparkline {
      height: 40px;
      width: 100%;
      margin-top: 12px;
    }
    .kpi-insight {
      font-size: 12px;
      color: #64748b;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #e2e8f0;
    }

    /* Charts */
    .chart-container {
      width: 100%;
      height: 400px;
      margin: 24px 0;
    }
    .chart-container-large { height: 500px; }
    .chart-container-small { height: 300px; }
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
      margin: 24px 0;
    }
    .chart-grid-3 {
      grid-template-columns: repeat(3, 1fr);
    }

    /* Insight boxes */
    .insight-box {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      border-left: 4px solid #f59e0b;
      padding: 20px;
      border-radius: 12px;
      margin-top: 24px;
    }
    .insight-box h4 {
      font-size: 16px;
      font-weight: 700;
      color: #92400e;
      margin-bottom: 12px;
    }
    .insight-box p {
      font-size: 14px;
      color: #78350f;
      line-height: 1.6;
    }

    /* Table */
    .table-container {
      overflow-x: auto;
      margin: 24px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }
    th {
      background: #f1f5f9;
      padding: 12px;
      text-align: left;
      font-weight: 600;
      color: #0f172a;
      border-bottom: 2px solid #e2e8f0;
    }
    td {
      padding: 12px;
      border-bottom: 1px solid #e2e8f0;
    }
    tr:hover { background: #f8fafc; }
    .status-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
    }
    .status-badge.delay { background: #fee2e2; color: #991b1b; }
    .status-badge.test { background: #fef3c7; color: #92400e; }
    .status-badge.ok { background: #dcfce7; color: #166534; }

    /* Filters */
    .filters {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    .filters select,
    .filters input {
      padding: 10px 14px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-size: 14px;
      background: white;
      color: #0f172a;
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 32px;
      color: #64748b;
      font-size: 13px;
      margin-top: 48px;
    }

    @media (max-width: 1400px) {
      .kpi-panel { grid-template-columns: repeat(3, 1fr); }
      .chart-grid { grid-template-columns: 1fr; }
    }
    @media (max-width: 768px) {
      .kpi-panel { grid-template-columns: 1fr; }
      .nav-sidebar { display: none; }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üöÑ –í–°–ú400 ‚Äî –¶–µ–Ω—Ç—Ä –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h1>
    <div class="header-controls">
      <span id="lastUpdate">–û–±–Ω–æ–≤–ª–µ–Ω–æ: 31.10.2025 14:30</span>
      <button onclick="exportPDF()">üìä –≠–∫—Å–ø–æ—Ä—Ç PDF</button>
      <button onclick="refreshData()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
    </div>
  </div>

  <div class="nav-sidebar">
    <a href="#kpi" onclick="scrollToSection('kpi'); return false;">KPI</a>
    <a href="#systems" onclick="scrollToSection('systems'); return false;">–°–∏—Å—Ç–µ–º—ã</a>
    <a href="#nodes" onclick="scrollToSection('nodes'); return false;">–£–∑–ª—ã</a>
    <a href="#suppliers" onclick="scrollToSection('suppliers'); return false;">–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏</a>
    <a href="#finance" onclick="scrollToSection('finance'); return false;">–§–∏–Ω–∞–Ω—Å—ã</a>
    <a href="#risks" onclick="scrollToSection('risks'); return false;">–†–∏—Å–∫–∏</a>
    <a href="#components" onclick="scrollToSection('components'); return false;">–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</a>
  </div>

  <div class="container">
    <!-- –ë–ª–æ–∫ 1: Master KPI Panel -->
    <section id="kpi" class="section">
      <h2 class="section-title">üìä –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞</h2>
      <p class="section-subtitle">–ò–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ–µ–∫—Ç–∞ "–°–æ–∑–¥–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–≥–æ –ø–æ–µ–∑–¥–∞"</p>
      
      <div class="kpi-panel">
        <div class="kpi-card status-info">
          <div class="kpi-header">
            <div class="kpi-label">–ò–Ω–¥–µ–∫—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞</div>
            <div class="kpi-trend">üî∫ +2% –∫ –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–µ</div>
          </div>
          <div class="kpi-value" id="kpi-readiness">83%</div>
          <div class="kpi-sparkline" id="spark-readiness"></div>
          <div class="kpi-insight">–û—Å–Ω–æ–≤–Ω–æ–π —Ä–∏—Å–∫ ‚Äî –ø–æ—Å—Ç–∞–≤—â–∏–∫ Stauff (HVAC, –∑–∞–¥–µ—Ä–∂–∫–∞ –∏—Å–ø—ã—Ç–∞–Ω–∏–π)</div>
        </div>

        <div class="kpi-card status-warn">
          <div class="kpi-header">
            <div class="kpi-label">–°—Ä–µ–¥–Ω–µ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ —Å—Ä–æ–∫–∞–º</div>
            <div class="kpi-trend">üîª -3 –¥–Ω—è</div>
          </div>
          <div class="kpi-value" id="kpi-schedule">+8 –¥–Ω–µ–π</div>
          <div class="kpi-sparkline" id="spark-schedule"></div>
          <div class="kpi-insight">3 —Å–∏—Å—Ç–µ–º—ã —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏ (>15 –¥–Ω–µ–π)</div>
        </div>

        <div class="kpi-card status-ok">
          <div class="kpi-header">
            <div class="kpi-label">–û—Å–≤–æ–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞</div>
            <div class="kpi-trend">üî∫ +1% –ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥</div>
          </div>
          <div class="kpi-value" id="kpi-budget">94%</div>
          <div class="kpi-sparkline" id="spark-budget"></div>
          <div class="kpi-insight">–û—Ç –ø–ª–∞–Ω–∞: 94% –æ—Ç –ø–ª–∞–Ω–∞</div>
        </div>

        <div class="kpi-card status-info">
          <div class="kpi-header">
            <div class="kpi-label">–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤</div>
            <div class="kpi-trend">‚Üí —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ</div>
          </div>
          <div class="kpi-value" id="kpi-quality">7.6 / 10</div>
          <div class="kpi-sparkline" id="spark-quality"></div>
          <div class="kpi-insight">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∞—É–¥–∏—Ç–∞: 7.6 –∏–∑ 10</div>
        </div>

        <div class="kpi-card status-crit">
          <div class="kpi-header">
            <div class="kpi-label">–î–æ–ª—è –û–ö–† —Å —Ä–∏—Å–∫–∞–º–∏</div>
            <div class="kpi-trend">üî∫ +3%</div>
          </div>
          <div class="kpi-value" id="kpi-risk">21%</div>
          <div class="kpi-sparkline" id="spark-risk"></div>
          <div class="kpi-insight">38 –∏–∑ 180 –û–ö–† –∏–º–µ—é—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è</div>
        </div>
      </div>

      <div class="insight-box">
        <h4>üí° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h4>
        <p>–ü—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –≤ —Ç—è–≥–æ–≤–æ–π –∏ HVAC-—Å–∏—Å—Ç–µ–º–∞—Ö. 14 –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ —Ç—Ä–µ–±—É—é—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞. –°—Ä–µ–¥–Ω—è—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ 83%, –ø—Ä–æ–≥–Ω–æ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚Äî –º–∞—Ä—Ç 2026.</p>
      </div>
    </section>

    <!-- –ë–ª–æ–∫ 2: –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø–æ —Å–∏—Å—Ç–µ–º–∞–º -->
    <section id="systems" class="section">
      <h2 class="section-title">‚öôÔ∏è –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø–æ —Å–∏—Å—Ç–µ–º–∞–º</h2>
      <p class="section-subtitle">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ 10 –æ—Å–Ω–æ–≤–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º –ø–æ–µ–∑–¥–∞</p>

      <div class="chart-container-large" id="chart-systems"></div>

      <div class="insight-box">
        <h4>üß† –ê–≤—Ç–æ–∞–Ω–∞–ª–∏–∑</h4>
        <p>3 –∏–∑ 10 —Å–∏—Å—Ç–µ–º –∏–º–µ—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏. –û—Å–Ω–æ–≤–Ω–æ–π —Ä–∏—Å–∫: –¢—è–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (—Ä–µ–¥—É–∫—Ç–æ—Ä—ã, –ø–æ—Å—Ç–∞–≤—â–∏–∫ Stauff, +14 –¥–Ω–µ–π). –°–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø–µ—Ä–µ–∂–∞—é—Ç –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ 3-5%.</p>
      </div>
    </section>

    <!-- –ë–ª–æ–∫ 3: –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø–æ —É–∑–ª–∞–º -->
    <section id="nodes" class="section">
      <h2 class="section-title">üß© –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø–æ —É–∑–ª–∞–º (64 —É–∑–ª–∞)</h2>
      <p class="section-subtitle">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –±—É—Ç—ã–ª–æ—á–Ω—ã—Ö –≥–æ—Ä–ª—ã—à–µ–∫</p>

      <div class="chart-container-large" id="chart-nodes-treemap"></div>

      <div class="chart-grid">
        <div class="chart-container" id="chart-nodes-distribution"></div>
        <div class="chart-container" id="chart-nodes-by-system"></div>
      </div>

      <div class="insight-box">
        <h4>üí° –ö–ª—é—á–µ–≤—ã–µ —É–∑–ª—ã —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏</h4>
        <p>–£–∑–µ–ª '–ò–Ω–≤–µ—Ä—Ç–æ—Ä–Ω—ã–π –±–ª–æ–∫' ‚Äî –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å 74%, 2 –∑–∞–¥–µ—Ä–∂–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (Klemsan, Glenair). –£–∑–µ–ª '–†–µ–¥—É–∫—Ç–æ—Ä —Ç—è–≥–æ–≤—ã–π' ‚Äî –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å 65%, –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ Stauff (+18 –¥–Ω–µ–π).</p>
      </div>
    </section>

    <!-- –ë–ª–æ–∫ 4: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ -->
    <section id="suppliers" class="section">
      <h2 class="section-title">üè≠ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤</h2>
      <p class="section-subtitle">–ê–Ω–∞–ª–∏–∑ 120 –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤: 70 üá∑üá∫ –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö, 50 üåç –∑–∞—Ä—É–±–µ–∂–Ω—ã—Ö</p>

      <div class="chart-grid">
        <div class="chart-container" id="chart-suppliers-pie"></div>
        <div class="chart-container" id="chart-suppliers-rating"></div>
      </div>
      <div class="chart-container" id="chart-suppliers-bubble"></div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
              <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
              <th>–°—Ä–µ–¥–Ω–∏–π –∞—É–¥–∏—Ç</th>
              <th>–û–±—â–∞—è –¥–æ–ª—è</th>
              <th>–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>üá∑üá∫ –û—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ</td>
              <td>70</td>
              <td>7.8</td>
              <td>62%</td>
              <td>9</td>
            </tr>
            <tr>
              <td>üåç –ó–∞—Ä—É–±–µ–∂–Ω—ã–µ</td>
              <td>50</td>
              <td>8.3</td>
              <td>38%</td>
              <td>3</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="insight-box">
        <h4>üß† –í—ã–≤–æ–¥</h4>
        <p>–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞—Ä—É–±–µ–∂–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤, 62% —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫—É–ø–æ–∫ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö. –†–∏—Å–∫–∏ ‚Äî –¥–∏—Å–±–∞–ª–∞–Ω—Å —Å—Ä–æ–∫–æ–≤ –º–µ–∂–¥—É –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏ –∏–º–ø–æ—Ä—Ç–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ HVAC –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.</p>
      </div>
    </section>

    <!-- –ë–ª–æ–∫ 5: –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
    <section id="finance" class="section">
      <h2 class="section-title">üßÆ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
      <p class="section-subtitle">–ë—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ —Å–∏—Å—Ç–µ–º–∞–º –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–µ—Ä–∏–æ–¥–∞–º</p>

      <div class="chart-container-large" id="chart-finance-stacked"></div>
      <div class="chart-grid">
        <div class="chart-container" id="chart-finance-timeline"></div>
        <div class="chart-container" id="chart-finance-top10"></div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>–°–∏—Å—Ç–µ–º–∞</th>
              <th>–ü–ª–∞–Ω (–º–ª–Ω ‚ÇΩ)</th>
              <th>–§–∞–∫—Ç (–º–ª–Ω ‚ÇΩ)</th>
              <th>% –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è</th>
              <th>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
            </tr>
          </thead>
          <tbody id="finance-table-body"></tbody>
        </table>
      </div>

      <div class="insight-box">
        <h4>üí° –ê–Ω–∞–ª–∏–∑ –±—é–¥–∂–µ—Ç–∞</h4>
        <p>–û–±—â–∏–π –±—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞: 1.2 –º–ª—Ä–¥ ‚ÇΩ. –û—Å–≤–æ–µ–Ω–æ: 1.128 –º–ª—Ä–¥ ‚ÇΩ (94%). –ü–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥ –ø–æ —Å–∏—Å—Ç–µ–º–µ —Ç—è–≥–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 12 –º–ª–Ω ‚ÇΩ (10%), —á—Ç–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç—Å—è —ç–∫–æ–Ω–æ–º–∏–µ–π –ø–æ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ (-4 –º–ª–Ω ‚ÇΩ, 95%).</p>
      </div>
    </section>

    <!-- –ë–ª–æ–∫ 6: –†–∏—Å–∫–∏ –∏ –∞—É–¥–∏—Ç—ã -->
    <section id="risks" class="section">
      <h2 class="section-title">üßæ –†–∏—Å–∫–∏ –∏ –∞—É–¥–∏—Ç—ã</h2>
      <p class="section-subtitle">–ú–∞—Ç—Ä–∏—Ü–∞ —Ä–∏—Å–∫–æ–≤ –û–ö–† –∏ —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –ø–æ –∫–∞—á–µ—Å—Ç–≤—É</p>

      <div class="chart-container-large" id="chart-risks-matrix"></div>
      <div class="chart-grid">
        <div class="chart-container" id="chart-risks-scatter"></div>
        <div class="chart-container" id="chart-risks-density"></div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>–ü–æ—Å—Ç–∞–≤—â–∏–∫</th>
              <th>–°–∏—Å—Ç–µ–º–∞</th>
              <th>–û—Ü–µ–Ω–∫–∞ –∞—É–¥–∏—Ç–∞</th>
              <th>–ü—Ä–æ–±–ª–µ–º—ã</th>
              <th>–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞</th>
            </tr>
          </thead>
          <tbody id="risks-table-body"></tbody>
        </table>
      </div>

      <div class="insight-box">
        <h4>‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏</h4>
        <p>21% –û–ö–† –∏–º–µ—é—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è. –í—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏ –≤ —Å—Ç–∞–¥–∏–∏ "–ò—Å–ø—ã—Ç–∞–Ω–∏—è" —Å–∏—Å—Ç–µ–º—ã —Ç—è–≥–∏: 3 –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¢–ó. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø—Ä–æ–≤–µ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞—É–¥–∏—Ç —É–∑–ª–∞ "–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä" –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ Stauff (HVAC).</p>
      </div>
    </section>

    <!-- –ë–ª–æ–∫ 7: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π —Å—Ä–µ–∑ -->
    <section id="components" class="section">
      <h2 class="section-title">üî© –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π —Å—Ä–µ–∑ (3000+ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)</h2>
      <p class="section-subtitle">–î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Å–∏—Å—Ç–µ–º–µ, —É–∑–ª—É, –ø–æ—Å—Ç–∞–≤—â–∏–∫—É, —Å—Ç–∞—Ç—É—Å—É –∏ —Å—Ç–∞–¥–∏–∏</p>

      <div class="filters">
        <select id="filter-system">
          <option value="">–í—Å–µ —Å–∏—Å—Ç–µ–º—ã</option>
        </select>
        <select id="filter-node">
          <option value="">–í—Å–µ —É–∑–ª—ã</option>
        </select>
        <select id="filter-supplier">
          <option value="">–í—Å–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏</option>
        </select>
        <select id="filter-status">
          <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
          <option value="ok">–í –≥—Ä–∞—Ñ–∏–∫–µ</option>
          <option value="test">–í —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏</option>
          <option value="delay">–ó–∞–¥–µ—Ä–∂–∫–∞</option>
        </select>
        <select id="filter-stage">
          <option value="">–í—Å–µ —Å—Ç–∞–¥–∏–∏</option>
          <option value="supply">–ü–æ—Å—Ç–∞–≤–∫–∞</option>
          <option value="rnd">–û–ö–†</option>
          <option value="test">–ò—Å–ø—ã—Ç–∞–Ω–∏—è</option>
          <option value="integration">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</option>
        </select>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç</th>
              <th>–ü–æ—Å—Ç–∞–≤—â–∏–∫</th>
              <th>–°–∏—Å—Ç–µ–º–∞ / –£–∑–µ–ª</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–≠—Ç–∞–ø</th>
              <th>–ü–ª–∞–Ω</th>
              <th>–§–∞–∫—Ç</th>
              <th>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
              <th>–ê—É–¥–∏—Ç</th>
              <th>–°—Ç–æ–∏–º–æ—Å—Ç—å</th>
            </tr>
          </thead>
          <tbody id="components-table-body"></tbody>
        </table>
      </div>

      <div class="insight-box">
        <h4>üìä –°–≤–æ–¥ –ø–æ –∑–∞–¥–µ—Ä–∂–∫–∞–º –∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è–º</h4>
        <p>14% –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–º–µ—é—Ç –∑–∞–¥–µ—Ä–∂–∫—É >7 –¥–Ω–µ–π, 4% ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (>15 –¥–Ω–µ–π). –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ —Å–≤—è–∑–∞–Ω—ã —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏ Stauff (HVAC, 8 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤), –û–û–û "–¢–†–ê–ù–°–ö–û–ù" (–¢—è–≥–∞, 5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤). 92% –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–æ—à–ª–∏ –∞—É–¥–∏—Ç —Å –æ—Ü–µ–Ω–∫–æ–π ‚â•7.0.</p>
      </div>
    </section>

    <div class="footer">
      –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: –æ–Ω–ª–∞–π–Ω ‚Ä¢ –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–î –í–°–ú400 ‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç<br>
      –ö–æ–Ω—Ç–∞–∫—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞: analytics@vsm400.live ‚Ä¢ –í–µ—Ä—Å–∏—è –¥–∞—à–±–æ—Ä–¥–∞: 2.0
    </div>
  </div>

  <script>
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—à–∏—Ä–Ω—ã—Ö –ø—Å–µ–≤–¥–æ–¥–∞–Ω–Ω—ã—Ö
    const generateMockData = () => {
      const systems = [
        { id: 'traction', name: '–°–∏—Å—Ç–µ–º–∞ —Ç—è–≥–∏', nodes: 8 },
        { id: 'brake', name: '–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞', nodes: 6 },
        { id: 'control', name: '–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', nodes: 12 },
        { id: 'body', name: '–ö—É–∑–æ–≤', nodes: 10 },
        { id: 'doors', name: '–î–≤–µ—Ä–∏', nodes: 4 },
        { id: 'bogies', name: '–¢–µ–ª–µ–∂–∫–∏', nodes: 7 },
        { id: 'hvac', name: 'HVAC (–ú–∏–∫—Ä–æ–∫–ª–∏–º–∞—Ç)', nodes: 9 },
        { id: 'pantograph', name: '–¢–æ–∫–æ—Å—ä—ë–º', nodes: 3 },
        { id: 'power', name: '–ü–∏—Ç–∞–Ω–∏–µ', nodes: 5 },
        { id: 'safety', name: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', nodes: 10 }
      ];

      const nodes = [];
      let nodeId = 1;
      systems.forEach(s => {
        for (let i = 1; i <= s.nodes; i++) {
          nodes.push({
            id: nodeId++,
            name: `–£–∑–µ–ª ${i} ${s.name}`,
            system: s.id,
            systemName: s.name,
            progress: Math.floor(Math.random() * 30) + 60,
            cost: Math.floor(Math.random() * 50000000) + 10000000,
            status: Math.random() > 0.7 ? 'delay' : Math.random() > 0.5 ? 'test' : 'ok'
          });
        }
      });

      const suppliersDomestic = Array.from({ length: 70 }, (_, i) => ({
        id: `ru_${i + 1}`,
        name: `–û–û–û "${['–ö–°–ö', '–¢–†–ê–ù–°–ö–û–ù', '–ö–û–ù–¢–ò–ù–ï–ù–¢', '–ù–ü–û –°–ê–£–¢', '–ö–°–ö –≠–õ–ö–û–ú', '–¢–†–ê–ù–°–¢–ï–õ–ï–ö–û–ú', '–ú–¢–ó –¢–†–ê–ù–°–ú–ê–®', '–°–ò–°–¢–ï–ú–ê', '–≠–õ–ï–ö–¢–†–û', '–ú–ï–•–ê–ù–ò–ö–ê'][i % 10]}"`,
        country: 'RU',
        audit: Math.random() * 2 + 6.5,
        share: Math.random() * 5 + 0.5,
        cost: Math.floor(Math.random() * 200000000) + 20000000,
        category: Math.random() > 0.85 ? 'critical' : Math.random() > 0.7 ? 'new' : 'stable',
        incidents: Math.floor(Math.random() * 4)
      }));

      const suppliersForeign = Array.from({ length: 50 }, (_, i) => ({
        id: `fw_${i + 1}`,
        name: ['Stauff', 'Bossard', 'SCHNORR', 'Klemsan', 'Glenair', 'ABB', 'Siemens', 'Alstom'][i % 8],
        country: ['DE', 'CH', 'FR', 'US', 'IT', 'SE'][i % 6],
        audit: Math.random() * 2 + 7.0,
        share: Math.random() * 4 + 0.3,
        cost: Math.floor(Math.random() * 150000000) + 15000000,
        category: Math.random() > 0.9 ? 'critical' : 'stable',
        incidents: Math.floor(Math.random() * 3)
      }));

      const components = [];
      for (let i = 0; i < 3200; i++) {
        const node = nodes[Math.floor(Math.random() * nodes.length)];
        const supplier = Math.random() > 0.4 ? suppliersDomestic[Math.floor(Math.random() * suppliersDomestic.length)] : suppliersForeign[Math.floor(Math.random() * suppliersForeign.length)];
        const planDate = new Date(2025, Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1);
        const delay = Math.random() > 0.86 ? Math.floor(Math.random() * 20) + 1 : 0;
        const factDate = new Date(planDate);
        factDate.setDate(factDate.getDate() + delay);

        components.push({
          id: i + 1,
          name: `–ö–æ–º–ø–æ–Ω–µ–Ω—Ç ${i + 1}`,
          supplier: supplier.name,
          system: node.systemName,
          systemId: node.system,
          node: node.name,
          nodeId: node.id,
          status: delay > 15 ? 'delay' : delay > 7 ? 'test' : 'ok',
          stage: ['supply', 'rnd', 'test', 'integration'][Math.floor(Math.random() * 4)],
          planDate: planDate.toISOString().split('T')[0],
          factDate: factDate.toISOString().split('T')[0],
          deviation: delay,
          audit: Math.random() * 2 + 6.5,
          cost: Math.floor(Math.random() * 5000000) + 100000
        });
      }

      return {
        systems,
        nodes,
        suppliersDomestic,
        suppliersForeign,
        components,
        finance: systems.map(s => ({
          name: s.name,
          plan: Math.floor(Math.random() * 100000000) + 80000000,
          fact: 0 // –±—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω
        })).map(f => ({
          ...f,
          fact: Math.floor(f.plan * (0.85 + Math.random() * 0.15))
        })),
        risks: Array.from({ length: 38 }, (_, i) => ({
          supplier: [...suppliersDomestic, ...suppliersForeign][Math.floor(Math.random() * 120)].name,
          system: systems[Math.floor(Math.random() * systems.length)].name,
          audit: Math.random() * 2 + 5.5,
          problems: ['–∑–∞–¥–µ—Ä–∂–∫–∏ –∏—Å–ø—ã—Ç–∞–Ω–∏–π', '–¥–µ—Ñ–µ–∫—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤', '–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó', '—Å–¥–≤–∏–≥ —Å—Ä–æ–∫–æ–≤'][Math.floor(Math.random() * 4)],
          date: new Date(2025, Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1).toISOString().split('T')[0]
        }))
      };
    };

    const DATA = generateMockData();

    // –§—É–Ω–∫—Ü–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
    function renderKPISparks() {
      const sparkData = {
        readiness: [78, 79, 80, 81, 82, 83],
        schedule: [14, 13, 11, 10, 9, 8],
        budget: [90, 91, 92, 93, 93, 94],
        quality: [7.4, 7.5, 7.5, 7.6, 7.6, 7.6],
        risk: [18, 19, 19, 20, 20, 21]
      };

      Object.keys(sparkData).forEach(key => {
        const el = document.getElementById(`spark-${key}`);
        if (el) {
          const chart = echarts.init(el);
          chart.setOption({
            grid: { left: 0, right: 0, top: 0, bottom: 0 },
            xAxis: { type: 'category', show: false },
            yAxis: { type: 'value', show: false },
            series: [{
              type: 'line',
              data: sparkData[key],
              smooth: true,
              lineStyle: { width: 2, color: '#0099CC' },
              areaStyle: { color: { type: 'linear', x: 0, y: 0, x2: 0, y2: 1, colorStops: [{ offset: 0, color: 'rgba(0,153,204,0.3)' }, { offset: 1, color: 'rgba(0,153,204,0)' }] } },
              symbol: 'none'
            }]
          });
        }
      });
    }

    function renderSystemsChart() {
      const el = document.getElementById('chart-systems');
      if (!el) return;
      const chart = echarts.init(el);
      const sysData = DATA.systems.map(s => {
        const sysNodes = DATA.nodes.filter(n => n.system === s.id);
        const avgProgress = sysNodes.reduce((sum, n) => sum + n.progress, 0) / sysNodes.length;
        const avgDelay = Math.floor(Math.random() * 15) - 5;
        return {
          name: s.name,
          progress: Math.round(avgProgress),
          delay: avgDelay,
          budgetPct: 85 + Math.random() * 15
        };
      });

      chart.setOption({
        tooltip: {
          trigger: 'axis',
          formatter: (params) => {
            const p = params[0];
            const data = sysData[p.dataIndex];
            return `${p.seriesName}: ${p.value}%<br/>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: ${data.delay > 0 ? '+' : ''}${data.delay} –¥–Ω–µ–π<br/>–ë—é–¥–∂–µ—Ç: ${data.budgetPct.toFixed(1)}%`;
          }
        },
        legend: { data: ['–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å (%)', '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (–¥–Ω–∏)'] },
        xAxis: {
          type: 'category',
          data: sysData.map(s => s.name),
          axisLabel: { interval: 0, rotate: 30 }
        },
        yAxis: [
          { type: 'value', name: '–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å (%)', max: 100 },
          { type: 'value', name: '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (–¥–Ω–∏)', position: 'right' }
        ],
        series: [
          {
            name: '–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å (%)',
            type: 'bar',
            data: sysData.map(s => s.progress),
            itemStyle: { color: (params) => params.value >= 90 ? '#10b981' : params.value >= 80 ? '#f59e0b' : '#ef4444' }
          },
          {
            name: '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (–¥–Ω–∏)',
            type: 'line',
            yAxisIndex: 1,
            data: sysData.map(s => s.delay),
            itemStyle: { color: '#0099CC' },
            lineStyle: { width: 3 }
          }
        ]
      });
    }

    function renderNodesTreemap() {
      const el = document.getElementById('chart-nodes-treemap');
      if (!el) return;
      const chart = echarts.init(el);
      chart.setOption({
        tooltip: {
          formatter: (info) => {
            const data = DATA.nodes[info.dataIndex];
            return `${data.name}<br/>–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: ${data.progress}%<br/>–°—Ç–æ–∏–º–æ—Å—Ç—å: ${(data.cost / 1000000).toFixed(1)} –º–ª–Ω ‚ÇΩ`;
          }
        },
        series: [{
          type: 'treemap',
          roam: false,
          data: DATA.nodes.map(n => ({
            value: n.cost,
            name: n.name,
            itemStyle: {
              color: n.progress >= 85 ? '#10b981' : n.progress >= 70 ? '#f59e0b' : '#ef4444'
            }
          })),
          label: { show: true, formatter: '{b}\n{c}%' }
        }]
      });
    }

    function renderNodesDistribution() {
      const el = document.getElementById('chart-nodes-distribution');
      if (!el) return;
      const chart = echarts.init(el);
      const ranges = [
        { name: '90-100%', count: DATA.nodes.filter(n => n.progress >= 90).length },
        { name: '80-89%', count: DATA.nodes.filter(n => n.progress >= 80 && n.progress < 90).length },
        { name: '70-79%', count: DATA.nodes.filter(n => n.progress >= 70 && n.progress < 80).length },
        { name: '60-69%', count: DATA.nodes.filter(n => n.progress >= 60 && n.progress < 70).length },
        { name: '<60%', count: DATA.nodes.filter(n => n.progress < 60).length }
      ];
      chart.setOption({
        tooltip: { trigger: 'item' },
        series: [{
          type: 'pie',
          radius: '70%',
          data: ranges.map(r => ({ value: r.count, name: r.name }))
        }]
      });
    }

    function renderNodesBySystem() {
      const el = document.getElementById('chart-nodes-by-system');
      if (!el) return;
      const chart = echarts.init(el);
      const sysData = DATA.systems.map(s => {
        const sysNodes = DATA.nodes.filter(n => n.system === s.id);
        return {
          name: s.name,
          count: sysNodes.length,
          avgProgress: sysNodes.reduce((sum, n) => sum + n.progress, 0) / sysNodes.length
        };
      });
      chart.setOption({
        tooltip: { trigger: 'axis' },
        xAxis: { type: 'category', data: sysData.map(s => s.name), axisLabel: { interval: 0, rotate: 30 } },
        yAxis: { type: 'value', name: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤' },
        series: [{
          type: 'bar',
          data: sysData.map(s => s.count),
          itemStyle: { color: '#0099CC' }
        }]
      });
    }

    function renderSuppliersPie() {
      const el = document.getElementById('chart-suppliers-pie');
      if (!el) return;
      const chart = echarts.init(el);
      const ruTotal = DATA.suppliersDomestic.reduce((sum, s) => sum + s.cost, 0);
      const fwTotal = DATA.suppliersForeign.reduce((sum, s) => sum + s.cost, 0);
      const total = ruTotal + fwTotal;
      chart.setOption({
        tooltip: { formatter: '{b}: {c}% ({d}%)' },
        series: [{
          type: 'pie',
          radius: ['40%', '70%'],
          data: [
            { value: (ruTotal / total * 100).toFixed(1), name: 'üá∑üá∫ –û—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ' },
            { value: (fwTotal / total * 100).toFixed(1), name: 'üåç –ó–∞—Ä—É–±–µ–∂–Ω—ã–µ' }
          ]
        }]
      });
    }

    function renderSuppliersRating() {
      const el = document.getElementById('chart-suppliers-rating');
      if (!el) return;
      const chart = echarts.init(el);
      const ruAvg = DATA.suppliersDomestic.reduce((sum, s) => sum + s.audit, 0) / DATA.suppliersDomestic.length;
      const fwAvg = DATA.suppliersForeign.reduce((sum, s) => sum + s.audit, 0) / DATA.suppliersForeign.length;
      chart.setOption({
        tooltip: { trigger: 'axis' },
        xAxis: { type: 'category', data: ['üá∑üá∫ –û—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ', 'üåç –ó–∞—Ä—É–±–µ–∂–Ω—ã–µ'] },
        yAxis: { type: 'value', name: '–†–µ–π—Ç–∏–Ω–≥', min: 0, max: 10 },
        series: [{
          type: 'bar',
          data: [ruAvg.toFixed(1), fwAvg.toFixed(1)],
          itemStyle: { color: '#0099CC' },
          label: { show: true, position: 'top', formatter: '{c}/10' }
        }]
      });
    }

    function renderSuppliersBubble() {
      const el = document.getElementById('chart-suppliers-bubble');
      if (!el) return;
      const chart = echarts.init(el);
      const allSuppliers = [...DATA.suppliersDomestic.slice(0, 20), ...DATA.suppliersForeign.slice(0, 15)];
      chart.setOption({
        tooltip: { trigger: 'item' },
        xAxis: { type: 'value', name: '–û—Ü–µ–Ω–∫–∞ –∞—É–¥–∏—Ç–∞', min: 5, max: 10 },
        yAxis: { type: 'value', name: '–î–æ–ª—è –ø–æ—Å—Ç–∞–≤–æ–∫ (%)' },
        series: [{
          type: 'scatter',
          symbolSize: (data) => Math.sqrt(data[2]) * 3,
          data: allSuppliers.map(s => [s.audit, s.share, s.cost / 1000000]),
          label: { show: true, formatter: (params) => allSuppliers[params.dataIndex].name, fontSize: 10 }
        }]
      });
    }

    function renderFinanceStacked() {
      const el = document.getElementById('chart-finance-stacked');
      if (!el) return;
      const chart = echarts.init(el);
      chart.setOption({
        tooltip: { trigger: 'axis' },
        legend: { data: ['–ü–ª–∞–Ω', '–§–∞–∫—Ç'] },
        xAxis: { type: 'category', data: DATA.finance.map(f => f.name), axisLabel: { interval: 0, rotate: 30 } },
        yAxis: { type: 'value', name: '‚ÇΩ –º–ª–Ω' },
        series: [
          {
            name: '–ü–ª–∞–Ω',
            type: 'bar',
            stack: 'total',
            data: DATA.finance.map(f => (f.plan / 1000000).toFixed(1)),
            itemStyle: { color: '#94a3b8' }
          },
          {
            name: '–§–∞–∫—Ç',
            type: 'bar',
            stack: 'total',
            data: DATA.finance.map(f => (f.fact / 1000000).toFixed(1)),
            itemStyle: { color: '#0099CC' }
          }
        ]
      });
    }

    function renderFinanceTimeline() {
      const el = document.getElementById('chart-finance-timeline');
      if (!el) return;
      const chart = echarts.init(el);
      const months = ['–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω', '–ò—é–ª', '–ê–≤–≥', '–°–µ–Ω', '–û–∫—Ç', '–ù–æ—è', '–î–µ–∫'];
      const planData = [0, 10, 25, 45, 60, 75, 85, 92, 94, 94, 94, 94];
      const factData = [0, 9, 23, 43, 58, 73, 83, 90, 94, 94, 94, 94];
      chart.setOption({
        tooltip: { trigger: 'axis' },
        legend: { data: ['–ü–ª–∞–Ω', '–§–∞–∫—Ç'] },
        xAxis: { type: 'category', data: months },
        yAxis: { type: 'value', name: '–û—Å–≤–æ–µ–Ω–∏–µ (%)' },
        series: [
          { name: '–ü–ª–∞–Ω', type: 'line', data: planData, itemStyle: { color: '#94a3b8' } },
          { name: '–§–∞–∫—Ç', type: 'line', data: factData, itemStyle: { color: '#0099CC' } }
        ]
      });
    }

    function renderFinanceTop10() {
      const el = document.getElementById('chart-finance-top10');
      if (!el) return;
      const chart = echarts.init(el);
      const allSuppliers = [...DATA.suppliersDomestic, ...DATA.suppliersForeign];
      const top10 = allSuppliers.sort((a, b) => b.cost - a.cost).slice(0, 10);
      chart.setOption({
        tooltip: { trigger: 'axis' },
        xAxis: { type: 'value', name: '‚ÇΩ –º–ª–Ω' },
        yAxis: { type: 'category', data: top10.map(s => s.name), axisLabel: { interval: 0 } },
        series: [{
          type: 'bar',
          data: top10.map(s => (s.cost / 1000000).toFixed(1)),
          itemStyle: { color: '#0099CC' }
        }]
      });
    }

    function renderRisksMatrix() {
      const el = document.getElementById('chart-risks-matrix');
      if (!el) return;
      const chart = echarts.init(el);
      const stages = ['–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞', '–ò—Å–ø—ã—Ç–∞–Ω–∏—è', '–í–Ω–µ–¥—Ä–µ–Ω–∏–µ'];
      const sysNames = DATA.systems.map(s => s.name);
      const matrixData = [];
      stages.forEach((stage, si) => {
        sysNames.forEach((sys, yi) => {
          const risk = Math.random() > 0.7 ? 'high' : Math.random() > 0.5 ? 'medium' : 'low';
          matrixData.push([si, yi, risk === 'high' ? 2 : risk === 'medium' ? 1 : 0]);
        });
      });
      chart.setOption({
        tooltip: { trigger: 'item' },
        grid: { left: '15%', top: '10%' },
        xAxis: { type: 'category', data: stages },
        yAxis: { type: 'category', data: sysNames, axisLabel: { interval: 0, rotate: 0 } },
        visualMap: {
          type: 'piecewise',
          categories: ['–ù–∏–∑–∫–∏–π', '–°—Ä–µ–¥–Ω–∏–π', '–í—ã—Å–æ–∫–∏–π'],
          dimension: 2,
          inRange: { color: ['#10b981', '#f59e0b', '#ef4444'] },
          right: '5%'
        },
        series: [{
          type: 'scatter',
          data: matrixData,
          symbolSize: 50
        }]
      });
    }

    function renderRisksScatter() {
      const el = document.getElementById('chart-risks-scatter');
      if (!el) return;
      const chart = echarts.init(el);
      const allSuppliers = [...DATA.suppliersDomestic, ...DATA.suppliersForeign];
      chart.setOption({
        tooltip: { trigger: 'item' },
        xAxis: { type: 'value', name: '–û—Ü–µ–Ω–∫–∞ –∞—É–¥–∏—Ç–∞', min: 5, max: 10 },
        yAxis: { type: 'value', name: '–î–æ–ª—è –ø–æ—Å—Ç–∞–≤–æ–∫ (%)' },
        series: [{
          type: 'scatter',
          symbolSize: (data) => Math.sqrt(data[2]) * 2,
          data: allSuppliers.map(s => [s.audit, s.share, s.incidents])
        }]
      });
    }

    function renderRisksDensity() {
      const el = document.getElementById('chart-risks-density');
      if (!el) return;
      const chart = echarts.init(el);
      const riskTypes = ['–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó', '–°–¥–≤–∏–≥ —Å—Ä–æ–∫–æ–≤', '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã', '–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–∞–≤–æ–∫'];
      const counts = [8, 12, 5, 3];
      chart.setOption({
        tooltip: { trigger: 'item' },
        series: [{
          type: 'pie',
          radius: '70%',
          data: riskTypes.map((t, i) => ({ value: counts[i], name: t }))
        }]
      });
    }

    function renderFinanceTable() {
      const tbody = document.getElementById('finance-table-body');
      if (!tbody) return;
      tbody.innerHTML = DATA.finance.map(f => {
        const pct = (f.fact / f.plan * 100).toFixed(1);
        const diff = f.fact - f.plan;
        return `<tr>
          <td>${f.name}</td>
          <td>${(f.plan / 1000000).toFixed(1)}</td>
          <td>${(f.fact / 1000000).toFixed(1)}</td>
          <td>${pct}%</td>
          <td style="color: ${diff > 0 ? '#ef4444' : '#10b981'}">${diff > 0 ? '+' : ''}${(diff / 1000000).toFixed(1)}</td>
        </tr>`;
      }).join('');
    }

    function renderRisksTable() {
      const tbody = document.getElementById('risks-table-body');
      if (!tbody) return;
      tbody.innerHTML = DATA.risks.slice(0, 10).map(r => `<tr>
        <td>${r.supplier}</td>
        <td>${r.system}</td>
        <td>${r.audit.toFixed(1)}</td>
        <td>${r.problems}</td>
        <td>${r.date}</td>
      </tr>`).join('');
    }

    function renderComponentsTable() {
      const tbody = document.getElementById('components-table-body');
      if (!tbody) return;
      const filtered = DATA.components.slice(0, 500); // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 500 –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
      tbody.innerHTML = filtered.map(c => {
        const statusClass = c.status === 'delay' ? 'delay' : c.status === 'test' ? 'test' : 'ok';
        const statusText = c.status === 'delay' ? '–ó–∞–¥–µ—Ä–∂–∫–∞' : c.status === 'test' ? '–¢–µ—Å—Ç' : '–í –≥—Ä–∞—Ñ–∏–∫–µ';
        const stageText = { supply: '–ü–æ—Å—Ç–∞–≤–∫–∞', rnd: '–û–ö–†', test: '–ò—Å–ø—ã—Ç–∞–Ω–∏—è', integration: '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è' }[c.stage];
        return `<tr>
          <td>${c.name}</td>
          <td>${c.supplier}</td>
          <td>${c.system} / ${c.node}</td>
          <td><span class="status-badge ${statusClass}">${statusText}</span></td>
          <td>${stageText}</td>
          <td>${c.planDate}</td>
          <td>${c.factDate}</td>
          <td style="color: ${c.deviation > 0 ? '#ef4444' : '#10b981'}">${c.deviation > 0 ? '+' : ''}${c.deviation}</td>
          <td>${c.audit.toFixed(1)}</td>
          <td>${(c.cost / 1000).toFixed(0)} —Ç—ã—Å ‚ÇΩ</td>
        </tr>`;
      }).join('');
    }

    function populateFilters() {
      const sysSelect = document.getElementById('filter-system');
      DATA.systems.forEach(s => {
        sysSelect.innerHTML += `<option value="${s.id}">${s.name}</option>`;
      });

      const nodeSelect = document.getElementById('filter-node');
      DATA.nodes.forEach(n => {
        nodeSelect.innerHTML += `<option value="${n.id}">${n.name}</option>`;
      });

      const supSelect = document.getElementById('filter-supplier');
      [...DATA.suppliersDomestic, ...DATA.suppliersForeign].forEach(s => {
        supSelect.innerHTML += `<option value="${s.name}">${s.name}</option>`;
      });
    }

    // Scroll animations
    const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -100px 0px' };
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, observerOptions);

    function scrollToSection(id) {
      const el = document.getElementById(id);
      if (el) {
        el.scrollIntoView({ behavior: 'smooth', block: 'start' });
        document.querySelectorAll('.nav-sidebar a').forEach(a => a.classList.remove('active'));
        document.querySelector(`.nav-sidebar a[href="#${id}"]`)?.classList.add('active');
      }
    }

    function exportPDF() {
      alert('–≠–∫—Å–ø–æ—Ä—Ç PDF –æ—Ç—á—ë—Ç–∞ (—Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞)');
    }

    function refreshData() {
      document.getElementById('lastUpdate').textContent = `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${new Date().toLocaleString('ru-RU')}`;
      alert('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    window.addEventListener('load', () => {
      document.querySelectorAll('.section').forEach(s => observer.observe(s));
      renderKPISparks();
      renderSystemsChart();
      renderNodesTreemap();
      renderNodesDistribution();
      renderNodesBySystem();
      renderSuppliersPie();
      renderSuppliersRating();
      renderSuppliersBubble();
      renderFinanceStacked();
      renderFinanceTimeline();
      renderFinanceTop10();
      renderRisksMatrix();
      renderRisksScatter();
      renderRisksDensity();
      renderFinanceTable();
      renderRisksTable();
      renderComponentsTable();
      populateFilters();

      // Auto refresh every 10 minutes
      setInterval(() => {
        refreshData();
      }, 600000);
    });
  </script>
</body>
</html>
